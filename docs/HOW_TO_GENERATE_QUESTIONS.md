# 3級問題の生成手順

> 2025-12: 本手順書は `docs/PROJECT_RULES.md` と `.cursor/rules/ai-question-rules.mdc` の最新ルールと連携しています。新しい項目を追加する際は先にそちらを確認してください。

## 概要

新しいセクション構成に基づいて、AIで問題を生成する手順を説明します。

## 前提条件

- Gemini APIキーが `.env.local` に設定されていること
- アプリケーションが起動していること

## 生成手順

### 1. アプリケーションを起動

```bash
npm run dev
```

### 2. ブラウザでアプリにアクセス

`http://localhost:5173` を開く

### 3. AIで問題を生成

各セクションごとに以下の手順で生成：

#### Section1: 記述統計とグラフ読解

**サブセクション1** - ヒストグラムと箱ひげ図
```
セクション名: 記述統計とグラフ読解 - ヒストグラムと箱ひげ図
級: 3級
問題数: 10

詳細プロンプト:
ヒストグラムまたは箱ひげ図を必ず含めてください。以下の内容を中心に：
- ヒストグラムから中央値や平均値が含まれる階級を読み取る問題
- 箱ひげ図から四分位範囲を読み取る問題
- 複数のグラフを比較して分布の特徴を判断する問題
全ての問題に図表を含めてください。
```

**サブセクション2** - 度数分布表と統計量計算
```
セクション名: 記述統計とグラフ読解 - 度数分布表と統計量
級: 3級
問題数: 10

詳細プロンプト:
度数分布表を使った問題を作成してください：
- 度数分布表から平均値、中央値を計算する問題
- 累積相対度数を計算する問題
- 度数分布表とヒストグラムの対応を問う問題
```

**サブセクション3** - 幹葉図と外れ値
```
セクション名: 記述統計とグラフ読解 - 幹葉図と外れ値
級: 3級
問題数: 10

詳細プロンプト:
幹葉図や外れ値に関する問題を作成してください：
- 幹葉図から中央値や範囲を読み取る問題
- 外れ値の影響を問う問題
- データを変換したときの統計量の変化を問う問題
```

#### Section2: 散布図・相関・単回帰分析

**サブセクション1** - 散布図と相関係数
```
セクション名: 散布図・相関・単回帰分析 - 散布図と相関
級: 3級
問題数: 10

詳細プロンプト:
必ず散布図を含めてください：
- 散布図から相関の強さと方向を判断する問題
- 相関係数の値を推定する問題
- 外れ値が相関係数に与える影響を問う問題
全ての問題に散布図を含めてください。
```

**サブセクション2** - 線形単回帰分析
```
セクション名: 散布図・相関・単回帰分析 - 単回帰分析
級: 3級
問題数: 10

詳細プロンプト:
線形単回帰分析に関する問題を作成してください（重回帰分析は含めない）：
- 散布図と回帰式から予測値を計算する問題
- 決定係数を解釈する問題
- 残差の意味を問う問題
可能な限り散布図を含めてください。
```

**サブセクション3** - データ変換と相関
```
セクション名: 散布図・相関・単回帰分析 - データ変換と相関
級: 3級
問題数: 10

詳細プロンプト:
データ変換が相関に与える影響を問う問題を作成してください：
- 1次変換（ax+b）が相関係数に与えない影響
- 単位変換と相関
- 共分散の計算
```

#### Section3: データの変換と統計量

**サブセクション1** - 1次変換の影響
```
セクション名: データの変換と統計量 - 1次変換
級: 3級
問題数: 10

詳細プロンプト:
データの1次変換に関する問題を作成してください：
- ax+b変換が平均値、標準偏差に与える影響
- 偏差値の計算
- 標準化（z得点）
具体的なデータを示して計算させる問題を中心に。
```

**サブセクション2** - 変動係数と比較
```
セクション名: データの変換と統計量 - 変動係数
級: 3級
問題数: 10

詳細プロンプト:
変動係数を用いた比較問題を作成してください：
- 平均が異なるデータのばらつきを比較
- 変動係数の計算
- どちらのデータがよりばらついているかを判断
```

#### Section4: 確率と確率分布

**サブセクション1** - 基本的な確率
```
セクション名: 確率と確率分布 - 基本的な確率
級: 3級
問題数: 10

詳細プロンプト:
基本的な確率計算問題を作成してください：
- 独立事象の確率
- 条件付き確率
- 余事象の確率
- 組合せ（nCr）の計算
具体的な状況設定を含めてください。
```

**サブセクション2** - 二項分布
```
セクション名: 確率と確率分布 - 二項分布
級: 3級
問題数: 10

詳細プロンプト:
二項分布に関する問題を作成してください：
- 反復試行の確率計算
- 二項分布の期待値
- n回中k回成功する確率
```

#### Section5: 推測統計の基礎

**サブセクション1** - 標本分布と信頼区間
```
セクション名: 推測統計の基礎 - 標本分布と信頼区間
級: 3級
問題数: 10

詳細プロンプト:
標本分布と信頼区間に関する問題を作成してください：
- 中心極限定理の概念
- 標本平均の期待値と分散
- 信頼区間の計算
- 信頼度と区間の幅の関係
t検定・F検定の具体的な手順は含めないでください。
```

**サブセクション2** - 仮説検定の基礎
```
セクション名: 推測統計の基礎 - 仮説検定の基礎
級: 3級
問題数: 10

詳細プロンプト:
仮説検定の基本概念を問う問題を作成してください：
- 帰無仮説と対立仮説の理解
- p値の意味と解釈
- 有意水準と検定結果の解釈
- 検定結果の正しい表現
第一種・第二種の過誤は含めないでください。
t検定・F検定・カイ二乗検定の具体的な手順は含めないでください。
```

#### Section6: クロス集計表・実験計画

**サブセクション1** - クロス集計表
```
セクション名: クロス集計表・実験計画 - クロス集計表
級: 3級
問題数: 10

詳細プロンプト:
クロス集計表を使った問題を作成してください：
- クロス集計表から割合を計算
- 条件付き割合の計算
- 2つの変数の関係を読み取る
- データの種類（量的・質的）の識別
全ての問題にクロス集計表を含めてください。
```

**サブセクション2** - 標本調査と実験計画
```
セクション名: クロス集計表・実験計画 - 標本調査と実験計画
級: 3級
問題数: 10

詳細プロンプト:
標本調査と実験計画の基礎を問う問題を作成してください：
- 母集団と標本の定義
- 無作為抽出の重要性
- 実験計画の基礎（無作為化、対応のあるデータ）
- バイアスの理解
具体的な調査や実験の状況設定を含めてください。
```

## 生成後の確認事項

各問題について以下を確認：
1. ✅ 図表が適切に含まれているか（85%の問題に図表）
2. ✅ 正解の選択肢が実際に正しいか（ファクトチェック済み）
3. ✅ 分数が既約分数になっているか
4. ✅ 範囲外の内容（t検定、F検定、第一種・第二種の過誤など）が含まれていないか
5. ✅ 概念選択問題ではなく、図表読み取りまたは計算問題になっているか

## ファイル名規則

生成したファイルは以下の命名規則で保存：
- `Section1_GraphReading_1.tsx` (記述統計とグラフ読解 - サブセクション1)
- `Section1_GraphReading_2.tsx` (記述統計とグラフ読解 - サブセクション2)
- `Section1_GraphReading_3.tsx` (記述統計とグラフ読解 - サブセクション3)
- `Section2_Correlation_1.tsx` (散布図・相関・単回帰分析 - サブセクション1)
- ...

## 注意事項

- **1回の生成は10問まで**にしてください（タイムアウト防止）
- 生成後は必ずファクトチェックが自動実行されます
- エラーが出た場合は問題数を減らして再試行してください
- 全14ファイルの生成には約20-30分かかります

