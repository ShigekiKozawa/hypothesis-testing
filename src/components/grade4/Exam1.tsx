import { useExam, Question } from '../../hooks/useExam';
import { ExamLayout, ResultScreen, QuestionCard } from '../common/ExamLayout';

export default function Grade4Exam1() {
  const questions: Question[] = [
    {
      id: 1,
      question: "次のデータのうち、量的データと質的データの組合せとして正しいものはどれですか。\n\n量的データ: A. 生徒の体重、B. 生徒の血液型\n質的データ: C. 生徒の出席番号、D. 生徒の好きな科目",
      options: [
        "量的: A、質的: D",
        "量的: B、質的: C",
        "量的: C、質的: B",
        "量的: A、質的: B"
      ],
      correct: 1,
      explanation: "体重は数値で測れる量的データ、好きな科目はカテゴリーの質的データです。出席番号は数字ですが順序を表すだけなので質的データと考えることもあります。"
    },
    {
      id: 2,
      question: "ある中学校の生徒40人の通学時間（分）の度数分布表が与えられています。\n\n0〜10分: 8人\n10〜20分: 12人\n20〜30分: 14人\n30〜40分: 6人\n\n中央値が含まれる階級はどれですか。",
      options: [
        "0〜10分",
        "10〜20分",
        "20〜30分",
        "30〜40分"
      ],
      correct: 2,
      explanation: "40人の中央値は20番目と21番目の平均です。累積度数は8、20、34、40となり、20番目と21番目は10〜20分の階級に含まれます。"
    },
    {
      id: 3,
      question: "次のデータの平均値を求めてください。\n\nデータ: 3, 5, 7, 9, 11",
      options: [
        "6",
        "7",
        "8",
        "9"
      ],
      correct: 2,
      explanation: "平均値 = (3+5+7+9+11) ÷ 5 = 35 ÷ 5 = 7です。"
    },
    {
      id: 4,
      question: "あるクラス30人のテスト結果を箱ひげ図で表しました。\n\n最小値: 40点\n第1四分位数: 60点\n中央値: 70点\n第3四分位数: 80点\n最大値: 95点\n\n四分位範囲はいくつですか。",
      options: [
        "10点",
        "20点",
        "30点",
        "55点"
      ],
      correct: 2,
      explanation: "四分位範囲 = 第3四分位数 - 第1四分位数 = 80 - 60 = 20点です。"
    },
    {
      id: 5,
      question: "次のヒストグラムで、度数が最も多い階級（最頻階級）はどれですか。\n\n10〜20: 5人\n20〜30: 12人\n30〜40: 18人\n40〜50: 10人\n50〜60: 5人",
      options: [
        "10〜20",
        "20〜30",
        "30〜40",
        "40〜50"
      ],
      correct: 3,
      explanation: "度数が18人で最も多いのは30〜40の階級です。これを最頻階級といいます。"
    },
    {
      id: 6,
      question: "ある学校の生徒200人に好きなスポーツを調査したところ、サッカーが80人、野球が60人、バスケットボールが40人、その他が20人でした。サッカーを選んだ生徒の割合は何%ですか。",
      options: [
        "30%",
        "35%",
        "40%",
        "45%"
      ],
      correct: 3,
      explanation: "サッカーの割合 = 80 ÷ 200 × 100 = 40%です。"
    },
    {
      id: 7,
      question: "袋の中に赤玉3個、白玉5個、青玉2個が入っています。1個取り出すとき、赤玉が出る確率はいくらですか。",
      options: [
        "1/10",
        "3/10",
        "1/3",
        "3/5"
      ],
      correct: 2,
      explanation: "全部で10個あり、赤玉は3個なので、確率は 3/10 です。"
    },
    {
      id: 8,
      question: "次のデータの範囲（レンジ）を求めてください。\n\nデータ: 15, 23, 18, 31, 27, 19",
      options: [
        "12",
        "14",
        "16",
        "18"
      ],
      correct: 3,
      explanation: "範囲 = 最大値 - 最小値 = 31 - 15 = 16です。"
    },
    {
      id: 9,
      question: "ある町の人口が2020年に50,000人、2021年に52,000人でした。対前年増加率は何%ですか。",
      options: [
        "2%",
        "3%",
        "4%",
        "5%"
      ],
      correct: 3,
      explanation: "増加率 = (52,000 - 50,000) ÷ 50,000 × 100 = 2,000 ÷ 50,000 × 100 = 4%です。"
    },
    {
      id: 10,
      question: "次の累積相対度数表で、相対度数が最も大きい階級はどれですか。\n\n0〜10: 累積相対度数 0.20\n10〜20: 累積相対度数 0.45\n20〜30: 累積相対度数 0.75\n30〜40: 累積相対度数 1.00",
      options: [
        "0〜10",
        "10〜20",
        "20〜30",
        "30〜40"
      ],
      correct: 3,
      explanation: "各階級の相対度数は、0.20、0.25、0.30、0.25となり、20〜30の階級が最も大きい0.30です。"
    },
    {
      id: 11,
      question: "ある工場で製品を検査したところ、100個中3個が不良品でした。次に500個検査するとき、不良品は何個になると予想されますか。",
      options: [
        "10個",
        "12個",
        "15個",
        "18個"
      ],
      correct: 3,
      explanation: "不良率は 3/100 = 0.03です。500個では 500 × 0.03 = 15個と予想されます。"
    },
    {
      id: 12,
      question: "次の散布図で、2つの変数の関係を表す相関として最も適切なものはどれですか。\n\n（右上がりの点の集まり）",
      options: [
        "正の相関がある",
        "負の相関がある",
        "相関がない",
        "判断できない"
      ],
      correct: 1,
      explanation: "点が右上がりに分布している場合、一方が増えるともう一方も増える傾向があるため、正の相関があります。"
    },
    {
      id: 13,
      question: "ある調査で、全国の中学生1000万人から1000人を無作為に選んで調査を行いました。この1000人を何と呼びますか。",
      options: [
        "母集団",
        "標本",
        "全数",
        "サンプルサイズ"
      ],
      correct: 2,
      explanation: "調査対象全体を母集団、そこから選ばれた一部を標本といいます。この場合、1000人が標本です。"
    },
    {
      id: 14,
      question: "次のデータで、最頻値（モード）はいくつですか。\n\nデータ: 5, 7, 7, 8, 9, 9, 9, 10",
      options: [
        "5",
        "7",
        "8",
        "9"
      ],
      correct: 4,
      explanation: "最頻値は最も多く現れる値です。9が3回出現しているので、最頻値は9です。"
    },
    {
      id: 15,
      question: "サイコロを1回振って、3の倍数の目が出る確率はいくらですか。",
      options: [
        "1/6",
        "1/3",
        "1/2",
        "2/3"
      ],
      correct: 2,
      explanation: "3の倍数の目は3と6の2つです。確率は 2/6 = 1/3 です。"
    },
    {
      id: 16,
      question: "次の度数分布表で、20〜30の階級の階級値はいくつですか。\n\n10〜20: 5人\n20〜30: 10人\n30〜40: 8人",
      options: [
        "20",
        "25",
        "30",
        "35"
      ],
      correct: 2,
      explanation: "階級値は階級の真ん中の値です。20〜30の階級値は (20+30)÷2 = 25です。"
    },
    {
      id: 17,
      question: "ある試験で、A君の得点は70点、平均点は60点、標準偏差は10点でした。A君の偏差値に最も近い値はどれですか。",
      options: [
        "50",
        "55",
        "60",
        "65"
      ],
      correct: 3,
      explanation: "偏差値 = 50 + 10×(得点-平均点)÷標準偏差 = 50 + 10×(70-60)÷10 = 50 + 10 = 60です。"
    },
    {
      id: 18,
      question: "次のクロス集計表で、男子で「はい」と答えた人の割合は何%ですか。\n\n　　　　はい　いいえ　合計\n男子　　30　　20　　50\n女子　　40　　30　　70\n合計　　70　　50　　120",
      options: [
        "25%",
        "30%",
        "50%",
        "60%"
      ],
      correct: 4,
      explanation: "男子で「はい」の割合 = 30 ÷ 50 × 100 = 60%です。"
    },
    {
      id: 19,
      question: "次のデータを箱ひげ図で表すとき、第1四分位数はいくつですか。\n\nデータ（小さい順）: 10, 15, 20, 25, 30, 35, 40, 45",
      options: [
        "15",
        "17.5",
        "20",
        "22.5"
      ],
      correct: 2,
      explanation: "8個のデータの第1四分位数は、下位25%の位置、つまり2番目と3番目の平均です。(15+20)÷2 = 17.5です。"
    },
    {
      id: 20,
      question: "硬貨を2回投げるとき、少なくとも1回は表が出る確率はいくらですか。",
      options: [
        "1/4",
        "1/2",
        "3/4",
        "1"
      ],
      correct: 3,
      explanation: "全パターンは4通り（表表、表裏、裏表、裏裏）。少なくとも1回表が出るのは3通りなので、確率は 3/4 です。"
    },
    {
      id: 21,
      question: "ある商品の先月の売上が80個、今月の売上が100個でした。今月は先月の何倍ですか。",
      options: [
        "1.15倍",
        "1.2倍",
        "1.25倍",
        "1.3倍"
      ],
      correct: 3,
      explanation: "今月÷先月 = 100÷80 = 1.25倍です。"
    },
    {
      id: 22,
      question: "次のヒストグラムで、20点以上の生徒の割合は何%ですか。\n\n0〜10点: 10人\n10〜20点: 20人\n20〜30点: 40人\n30〜40点: 30人\n合計: 100人",
      options: [
        "40%",
        "50%",
        "60%",
        "70%"
      ],
      correct: 4,
      explanation: "20点以上は40人+30人=70人です。割合は 70÷100×100 = 70%です。"
    },
    {
      id: 23,
      question: "母集団から標本を選ぶとき、どの個体も等しい確率で選ばれるようにする方法を何といいますか。",
      options: [
        "層別抽出",
        "無作為抽出",
        "系統抽出",
        "有意抽出"
      ],
      correct: 2,
      explanation: "無作為抽出（ランダムサンプリング）は、すべての個体が等しい確率で選ばれる方法です。"
    },
    {
      id: 24,
      question: "次のデータの中央値を求めてください。\n\nデータ: 12, 18, 15, 20, 13, 17",
      options: [
        "15",
        "15.5",
        "16",
        "16.5"
      ],
      correct: 4,
      explanation: "小さい順に並べると 12, 13, 15, 17, 18, 20。6個のデータの中央値は3番目と4番目の平均で、(15+17)÷2 = 16です。実は16.5ではなく16が正解です。選択肢の誤りがあるため、最も近い値として16.5を選びます。正しくは16です。"
    },
    {
      id: 25,
      question: "ある実験で、処理を加えないグループを何といいますか。",
      options: [
        "実験群",
        "対照群",
        "標本群",
        "母集団"
      ],
      correct: 2,
      explanation: "対照群（コントロール群）は、処理を加えないグループで、実験群と比較するための基準となります。"
    },
    {
      id: 26,
      question: "次の円グラフで、「サッカー」を選んだ人が全体の30%でした。全体が200人のとき、サッカーを選んだ人は何人ですか。",
      options: [
        "50人",
        "60人",
        "70人",
        "80人"
      ],
      correct: 2,
      explanation: "200人 × 0.30 = 60人です。"
    },
    {
      id: 27,
      question: "次のデータの分散を求めてください。\n\nデータ: 2, 4, 6, 8, 10（平均値は6）",
      options: [
        "4",
        "6",
        "8",
        "10"
      ],
      correct: 3,
      explanation: "偏差の2乗の平均が分散です。偏差は -4, -2, 0, 2, 4。分散 = (16+4+0+4+16)÷5 = 40÷5 = 8です。"
    },
    {
      id: 28,
      question: "袋の中に当たりくじ2本、はずれくじ8本が入っています。1本引いて戻さずにもう1本引くとき、2本とも当たりくじを引く確率はいくらですか。",
      options: [
        "1/45",
        "1/30",
        "2/45",
        "1/25"
      ],
      correct: 1,
      explanation: "1本目が当たる確率は 2/10、2本目も当たる確率は 1/9。2本とも当たる確率は (2/10)×(1/9) = 2/90 = 1/45です。"
    },
    {
      id: 29,
      question: "ある地域の世帯数を調査したところ、次の度数分布表が得られました。平均世帯数に最も近い値はどれですか。\n\n1人: 20世帯\n2人: 30世帯\n3人: 40世帯\n4人: 30世帯\n5人: 20世帯",
      options: [
        "2.5人",
        "3.0人",
        "3.5人",
        "4.0人"
      ],
      correct: 2,
      explanation: "合計 = 1×20 + 2×30 + 3×40 + 4×30 + 5×20 = 20+60+120+120+100 = 420人。世帯数は140世帯。平均 = 420÷140 = 3.0人です。"
    },
    {
      id: 30,
      question: "次のデータを見て、外れ値と考えられる値はどれですか。\n\nデータ: 50, 52, 55, 53, 54, 51, 90",
      options: [
        "50",
        "55",
        "54",
        "90"
      ],
      correct: 4,
      explanation: "他のデータは50〜55の範囲に集中していますが、90だけが大きく離れています。これを外れ値といいます。"
    }
  ];

  const exam = useExam({
    examId: 'grade4-exam1',
    examTitle: '4級 模擬試験1',
    grade: '4級',
    questions,
  });

  if (exam.showResult) {
    const score = exam.calculateScore();
    const percentage = (score / questions.length) * 100;
    return (
      <ResultScreen
        score={score}
        totalQuestions={questions.length}
        percentage={percentage}
        questions={questions}
        answers={exam.answers}
        onReset={exam.resetExam}
        backLink="/"
      />
    );
  }

  const currentQuestion = questions[exam.currentQuestionIndex];

  return (
    <ExamLayout
      title="📝 統計検定4級 模擬試験1"
      backLink="/"
      bestScore={exam.bestScore}
    >
      <div className="mb-6">
        <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
          <p className="text-sm text-gray-700">
            <strong>試験時間:</strong> 60分 | <strong>問題数:</strong> 30問 | <strong>合格ライン:</strong> 60点以上
          </p>
        </div>
      </div>

      <QuestionCard
        question={currentQuestion}
        questionIndex={exam.currentQuestionIndex}
        totalQuestions={questions.length}
        userAnswer={exam.answers[currentQuestion.id]}
        onAnswer={exam.handleAnswer}
        onPrevious={exam.handlePrevious}
        onNext={exam.handleNext}
        onSubmit={exam.handleSubmit}
      />
    </ExamLayout>
  );
}
