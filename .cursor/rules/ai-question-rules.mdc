# AI 問題生成ルール（.cursor/rules/ai-question-rules.mdc）

## 1. 出題範囲
- 3級：記述統計・散布図・相関・単回帰・確率分布・推測統計の基本（標本分布、信頼区間、仮説検定）に限定。  
- 4級：記述統計・グラフ読解（ヒストグラム、箱ひげ図、幹葉図、帯グラフ、散布図、クロス集計）と簡単な確率・割合。

## 2. 🔴 重点領域（採用度を増やす）【Grade3】
受験者の失点が特に多い以下の5分野を優先的に出題すること（各セクションで30-40%以上）：

1. **記述統計の「性質」**：外れ値の影響、ヒストグラム形状と代表値の大小関係、分散公式、変動係数、累積相対度数グラフ
2. **相関の計算と性質**：共分散の計算、相関係数の公式、相関と因果の区別、1次変換と相関の関係
3. **1次変換の影響**：平均・標準偏差・分散が1次変換（ax+b）でどう変わるか、偏差値の不変性
4. **確率と時系列**：反復試行、条件付き確率、幾何平均、移動平均
5. **調査・実験・公的統計**：無作為抽出の定義、実験計画法の原則、公的統計の管轄省庁

## 3. 絶対に出題しない項目（Grade3/模擬試験）
1. 不偏分散・母集団・標本の定義を掘り下げた問題（言葉の意味だけを問うもの）
2. カイ二乗検定（カテゴリーデータ間の独立性の検定）
3. 偏相関係数
4. 検出力（power）やβエラー関連の計算
5. F検定（分散比の検定）
6. t検定（t分布・t値の計算）
7. 多重比較（Bonferroni、Holmなど）の処理

## 4. 問題形式のルール
- 85%以上は図表読取（ヒストグラム、箱ひげ図、散布図、度数分布表、時系列等）、15%以下が計算問題（確率・SE・CI幅など）。
- 概念問題（定義や意味の選択）は禁止。具体的な数値・文脈を必ず含める。
- グラフ参照がある場合は `question` に「下の」「次の」「以下の」等を明記し、`chartType` とデータをセット。参照記述がない問題にはチャートフィールドを含めない。
- 数値選択肢（特に分数）は必ず既約分数で重複を避ける。

## 5. 生成・検証プロセス
- 問題生成後、`scripts/checkAndFixAnswers.js` で `correct` と `explanation` の整合性を検証。
- チャートが不要な問題には `chartType` を定義しない。必要な図表のみ出力。
- 変更を加えるたびに `npm run build` で型とビルドを確認。

## 6. 参考情報
- このルールは `docs/GRADE3_SCOPE_DETAILED.md` と `docs/PROJECT_RULES.md`、geminiClient のプロンプト内「重点領域」セクションにリンクされています。
