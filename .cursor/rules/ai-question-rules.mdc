# AI 問題生成ルール（.cursor/rules/ai-question-rules.mdc）

## 1. 出題範囲
- 3級：記述統計・散布図・相関・単回帰・確率分布・推測統計の基本（標本分布、信頼区間、仮説検定）に限定。  
- 4級：記述統計・グラフ読解（ヒストグラム、箱ひげ図、幹葉図、帯グラフ、散布図、クロス集計）と簡単な確率・割合。

## 2. 絶対に出題しない項目（Grade3/模擬試験）
1. 不偏分散・母集団・標本の定義を掘り下げた問題（言葉の意味だけを問うもの）
2. カイ二乗検定（カテゴリーデータ間の独立性の検定）
3. 偏相関係数
4. 検出力（power）やβエラー関連の計算
5. F検定（分散比の検定）
6. t検定（t分布・t値の計算）
7. 多重比較（Bonferroni、Holmなど）の処理

## 3. 問題形式のルール
- 85%以上は図表読取（ヒストグラム、箱ひげ図、散布図、度数分布表、時系列等）、15%以下が計算問題（確率・SE・CI幅など）。
- 概念問題（定義や意味の選択）は禁止。具体的な数値・文脈を必ず含める。
- グラフ参照がある場合は `question` に「下の」「次の」「以下の」等を明記し、`chartType` とデータをセット。参照記述がない問題にはチャートフィールドを含めない。
- 数値選択肢（特に分数）は必ず既約分数で重複を避ける。

## 4. 生成・検証プロセス
- 問題生成後、`scripts/checkAndFixAnswers.js` で `correct` と `explanation` の整合性を検証。
- チャートが不要な問題には `chartType` を定義しない。必要な図表のみ出力。
- 変更を加えるたびに `npm run build` で型とビルドを確認。

## 5. 参考情報
- このルールは `PROJECT_RULES.md` と geminiClient のプロンプト内「Project Rulesとの整合」セクションにリンクされています。
